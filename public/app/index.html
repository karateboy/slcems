<!DOCTYPE html>
<!-- 
Template Name:  SmartAdmin Responsive WebApp - Template build with Twitter Bootstrap 4
Version: 4.5.1
Author: Sunnyat A.
Website: http://gootbootstrap.com
Purchase: https://wrapbootstrap.com/theme/smartadmin-responsive-webapp-WB0573SK0?ref=myorange
License: You must have a valid license purchased only from wrapbootstrap.com (link above) in order to legally use this theme for your project.
-->
<html lang="zh-tw">

<head>
    <meta charset="utf-8">
    <title>
        首頁 - 沙崙科學園區 - v4.5.1
    </title>
    <meta name="description" content="首頁">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, minimal-ui">
    <!-- Call App Mode on ios devices -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Remove Tap Highlight on Windows Phone IE -->
    <meta name="msapplication-tap-highlight" content="no">
    <!-- base css -->
    <link id="vendorsbundle" rel="stylesheet" media="screen, print" href="css/vendors.bundle.css">
    <link id="appbundle" rel="stylesheet" media="screen, print" href="css/app.bundle.css">
    <link id="mytheme" rel="stylesheet" media="screen, print" href="css/themes/cust-theme-13.css">
    <link id="myskin" rel="stylesheet" media="screen, print" href="css/skins/skin-master.css">
    <!-- Place favicon.ico in the root directory -->
    <link rel="apple-touch-icon" sizes="180x180" href="img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon/favicon-32x32.png">
    <link rel="mask-icon" href="img/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="stylesheet" media="screen, print" href="css/miscellaneous/reactions/reactions.css">
    <link rel="stylesheet" media="screen, print" href="css/miscellaneous/fullcalendar/fullcalendar.bundle.css">
    <link rel="stylesheet" media="screen, print" href="css/miscellaneous/jqvmap/jqvmap.bundle.css">
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.24.0/axios.min.js"
        integrity="sha512-u9akINsQsAkG9xjc1cnGF4zw5TFDwkxuc9vUp5dltDWYCSmyd0meygbvgXrlc/z7/o4a19Fb5V0OUE58J7dcyw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment-with-locales.min.js"
        integrity="sha512-LGXaggshOkD/at6PFNcp2V2unf9LzFq6LE+sChH7ceMTDP0g2kn6Vxwgg7wkPP7AAtX+lmPqPdxB47A0Nz0cMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
</head>
<!-- BEGIN Body -->
<!-- Possible Classes

		* 'header-function-fixed'         - header is in a fixed at all times
		* 'nav-function-fixed'            - left panel is fixed
		* 'nav-function-minify'			  - skew nav to maximize space
		* 'nav-function-hidden'           - roll mouse on edge to reveal
		* 'nav-function-top'              - relocate left pane to top
		* 'mod-main-boxed'                - encapsulates to a container
		* 'nav-mobile-push'               - content pushed on menu reveal
		* 'nav-mobile-no-overlay'         - removes mesh on menu reveal
		* 'nav-mobile-slide-out'          - content overlaps menu
		* 'mod-bigger-font'               - content fonts are bigger for readability
		* 'mod-high-contrast'             - 4.5:1 text contrast ratio
		* 'mod-color-blind'               - color vision deficiency
		* 'mod-pace-custom'               - preloader will be inside content
		* 'mod-clean-page-bg'             - adds more whitespace
		* 'mod-hide-nav-icons'            - invisible navigation icons
		* 'mod-disable-animation'         - disables css based animations
		* 'mod-hide-info-card'            - hides info card from left panel
		* 'mod-lean-subheader'            - distinguished page header
		* 'mod-nav-link'                  - clear breakdown of nav links

		>>> more settings are described inside documentation page >>>
	-->

<body class="mod-bg-1 mod-nav-link ">
    <!-- DOC: script to save and load page settings -->
    <script>
        /**
         *	This script should be placed right after the body tag for fast execution 
         *	Note: the script is written in pure javascript and does not depend on thirdparty library
         **/
        'use strict';

        var classHolder = document.getElementsByTagName("BODY")[0],
            /** 
             * Load from localstorage
             **/
            themeSettings = {
                "themeOptions": "mod-bg-1 mod-nav-link nav-mobile-push mod-bigger-font",
                "themeURL": "css/themes/cust-theme-13.css"
            },
            themeURL = themeSettings.themeURL || '',
            themeOptions = themeSettings.themeOptions || '';
        /** 
         * Load theme options
         **/
        if (themeSettings.themeOptions) {
            classHolder.className = themeSettings.themeOptions;
            console.log("%c✔ Theme settings loaded", "color: #148f32");
        }
        else {
            console.log("%c✔ Heads up! Theme settings is empty or does not exist, loading default settings...", "color: #ed1c24");
        }
        if (themeSettings.themeURL && !document.getElementById('mytheme')) {
            var cssfile = document.createElement('link');
            cssfile.id = 'mytheme';
            cssfile.rel = 'stylesheet';
            cssfile.href = themeURL;
            document.getElementsByTagName('head')[0].appendChild(cssfile);

        }
        else if (themeSettings.themeURL && document.getElementById('mytheme')) {
            document.getElementById('mytheme').href = themeSettings.themeURL;
        }
        /** 
         * Save to localstorage 
         **/
        var saveSettings = function () {
            themeSettings.themeOptions = String(classHolder.className).split(/[^\w-]+/).filter(function (item) {
                return /^(nav|header|footer|mod|display)-/i.test(item);
            }).join(' ');
            if (document.getElementById('mytheme')) {
                themeSettings.themeURL = document.getElementById('mytheme').getAttribute("href");
            };
            localStorage.setItem('themeSettings', JSON.stringify(themeSettings));
        }
        /** 
         * Reset settings
         **/
        var resetSettings = function () {
            localStorage.setItem("themeSettings", "");
        }

    </script>
    <!-- BEGIN Page Wrapper -->
    <div class="page-wrapper">
        <div class="page-inner">
            <!-- BEGIN Left Aside -->
            <aside class="page-sidebar">
                <div class="page-logo">
                    <img src="img/logo.svg" alt="沙崙科學園區" aria-roledescription="logo">
                    <span class="page-logo-text text-center">沙崙智慧綠能科學城<br />電能管理系統資訊平臺</span>
                    <span class="position-absolute text-white opacity-50 small pos-top pos-right mr-2 mt-n2"></span>
                </div>
                <!-- BEGIN PRIMARY NAVIGATION -->
                <nav id="js-primary-nav" class="primary-nav" role="navigation">
                    <div class="nav-filter">
                        <div class="position-relative">
                            <input type="text" id="nav_filter_input" placeholder="Filter menu" class="form-control"
                                tabindex="0">
                            <a href="#" onclick="return false;" class="btn-primary btn-search-close js-waves-off"
                                data-action="toggle" data-class="list-filter-active" data-target=".page-sidebar">
                                <i class="fal fa-chevron-up"></i>
                            </a>
                        </div>
                    </div>
                    <div class="info-card">
                        <!-- <img src="img/demo/avatars/logo.svg" class="profile-image" alt="智慧綠能科學城"> -->
                        <!-- <div class="info-card-text">
                            <a href="#" class="d-flex align-items-center text-white">
                                <span class="text-truncate text-truncate-sm d-inline-block">
                                    智慧綠能科學城
                                </span>
                            </a>
                            <span class="d-inline-block text-truncate text-truncate-sm">沙崙, 臺南市</span>
                        </div> -->
                        <img src="img/card-backgrounds/cover-2-lg.png" class="cover" alt="cover">
                        <a href="#" onclick="return false;" class="pull-trigger-btn" data-action="toggle"
                            data-class="list-filter-active" data-target=".page-sidebar" data-focus="nav_filter_input">
                            <i class="fal fa-angle-down"></i>
                        </a>
                    </div>
                    <ul id="js-nav-menu" class="nav-menu">
                        <li class="active open">
                            <a href="#" title="" data-filter-tags="">
                                <i class="fal fa-info-circle"></i>
                                <span class="nav-link-text" data-i18n="nav."></span>
                            </a>
                            <ul>
                                <li class="active">
                                    <a href="index.html" title="首頁" data-filter-tags=" 首頁">
                                        <span class="nav-link-text" data-i18n="nav._首頁">首頁</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="smart_grid.html" title="區域電力資訊" data-filter-tags=" 區域電力資訊">
                                        <span class="nav-link-text" data-i18n="nav._區域電力資訊">區域電力資訊</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="neo_energy.html" title="再生能源" data-filter-tags=" 再生能源">
                                        <span class="nav-link-text" data-i18n="nav._再生能源">再生能源</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="energy_saving.html" title="節電成效" data-filter-tags=" 節電成效">
                                        <span class="nav-link-text" data-i18n="nav._節電成效">節電成效</span>
                                    </a>
                                </li>
                                <!-- <li>
                                    <a href="requirement_management.html" title="需量調控" data-filter-tags=" 需量調控">
                                        <span class="nav-link-text" data-i18n="nav._需量調控">需量調控</span>
                                    </a>
                                </li> -->
                                <li>
                                    <a href="links.html" title="友善連結" data-filter-tags=" 友善連結">
                                        <span class="nav-link-text" data-i18n="nav._友善連結">友善連結</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <div class="filter-message js-filter-message bg-success-600"></div>
                </nav>
                <!-- END PRIMARY NAVIGATION -->
                <!-- NAV FOOTER -->
            </aside>
            <!-- END Left Aside -->
            <div class="page-content-wrapper">
                <!-- BEGIN Page Header -->
                <header class="page-header" role="banner">
                    <!-- we need this logo when user switches to nav-function-top -->
                    <div class="page-logo">
                        <a href="#" class="page-logo-link press-scale-down d-flex align-items-center position-relative"
                            data-toggle="modal" data-target="#modal-shortcut">
                            <img src="img/logo.svg" alt="沙崙科學園區" aria-roledescription="logo">
                            <span class="page-logo-text mr-1">沙崙科學園區</span>
                            <span
                                class="position-absolute text-white opacity-50 small pos-top pos-right mr-2 mt-n2"></span>
                            <i class="fal fa-angle-down d-inline-block ml-1 fs-lg color-primary-300"></i>
                        </a>
                    </div>
                    <!-- DOC: nav menu layout change shortcut -->
                    <div class="hidden-md-down dropdown-icon-menu position-relative">
                        <a href="#" class="header-btn btn js-waves-off" data-action="toggle"
                            data-class="nav-function-hidden" title="Hide Navigation">
                            <i class="ni ni-menu"></i>
                        </a>
                        <ul>
                            <li>
                                <a href="#" class="btn js-waves-off" data-action="toggle"
                                    data-class="nav-function-minify" title="Minify Navigation">
                                    <i class="ni ni-minify-nav"></i>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="btn js-waves-off" data-action="toggle"
                                    data-class="nav-function-fixed" title="Lock Navigation">
                                    <i class="ni ni-lock-nav"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!-- DOC: mobile button appears during mobile width -->
                    <div class="hidden-lg-up">
                        <a href="#" class="header-btn btn press-scale-down" data-action="toggle"
                            data-class="mobile-nav-on">
                            <i class="ni ni-menu"></i>
                        </a>
                    </div>
                    <div class="search">
                        <form class="app-forms hidden-xs-down" role="search" action="page_search.html"
                            autocomplete="off">
                            <input type="text" id="search-field" placeholder="" class="form-control" tabindex="1">
                            <a href="#" onclick="return false;" class="btn-danger btn-search-close js-waves-off d-none"
                                data-action="toggle" data-class="mobile-search-on">
                                <i class="fal fa-times"></i>
                            </a>
                        </form>
                    </div>
                    <div class="ml-auto d-flex">
                        <!-- activate app search icon (mobile) -->
                        <div class="hidden-sm-up">
                            <a href="#" class="header-icon" data-action="toggle" data-class="mobile-search-on"
                                data-focus="search-field" title="Search">
                                <i class="fal fa-search"></i>
                            </a>
                        </div>
                        <!-- app settings -->
                        <!-- <div class="hidden-md-down">
                            <a href="#" class="header-icon" data-toggle="modal" data-target=".js-modal-settings">
                                <i class="fal fa-cog"></i>
                            </a>
                        </div> -->
                        <!-- app shortcuts -->
                        <!-- app notification -->
                        <!-- app user menu -->
                        <img src="img/demo/avatars/logo.svg" class="profile-image" alt="智慧綠能科學城">
                    </div>
                </header>
                <!-- END Page Header -->
                <!-- BEGIN Page Content -->
                <!-- the #js-page-content id is needed for some plugins to initialize -->
                <main id="js-page-content" role="main" class="page-content">
                    <div class="subheader">
                        <h1 class="subheader-title">
                            <i class='subheader-icon fal fa-chart-area'></i> 首頁 <span class='fw-300'></span>
                        </h1>
                        <div class="subheader-block d-lg-flex align-items-center">
                            <div class="d-inline-flex flex-column justify-content-center mr-3">
                                <span class="fw-300 fs-xs d-block opacity-50">
                                    <small>即時總發電量</small>
                                </span>
                                <span class="fw-500 fs-xl d-block color-primary-500">
                                    {{totalGenerating}} kW
                                </span>
                            </div>
                            <span class="sparklines hidden-lg-down" sparkType="bar" sparkBarColor="#886ab5"
                                sparkHeight="32px" sparkBarWidth="5px" values="3,4,3,6,7,3,3,6,2,6,4"></span>
                        </div>
                        <div
                            class="subheader-block d-lg-flex align-items-center border-faded border-right-0 border-top-0 border-bottom-0 ml-3 pl-3">
                            <div class="d-inline-flex flex-column justify-content-center mr-3">
                                <span class="fw-300 fs-xs d-block opacity-50">
                                    <small>即時總用電量</small>
                                </span>
                                <span class="fw-500 fs-xl d-block color-danger-500">
                                    {{totalConsuming}} kW
                                </span>
                            </div>
                            <span class="sparklines hidden-lg-down" sparkType="bar" sparkBarColor="#fe6bb0"
                                sparkHeight="32px" sparkBarWidth="5px" values="1,4,3,6,5,3,9,6,5,9,7"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="panel-1" class="panel panel-locked" data-panel-lock="false"
                                data-panel-close="false" data-panel-fullscreen="false" data-panel-collapsed="false"
                                data-panel-color="false" data-panel-locked="false" data-panel-refresh="false"
                                data-panel-reset="false">
                                <div class="panel-hdr">
                                    <h2>
                                        <strong>即時發用電資訊</strong>
                                    </h2>
                                </div>
                                <div class="panel-container show">
                                    <div class="panel-content border-faded border-left-0 border-right-0 border-top-0">
                                        <div class="row no-gutters">
                                            <div class="col-lg-7 col-xl-8">
                                                <div id="chart_container"></div>
                                            </div>
                                            <div class="col-lg-5 col-xl-4 pl-lg-3">
                                                <div class="d-flex p-3">
                                                    <h2>即時用電量</h2>
                                                </div>
                                                <div class="d-flex">
                                                    聯合研究中心
                                                    <span class="d-inline-block ml-auto">{{getPowerConsumping(0)}}
                                                        KW</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-success-500" role="progressbar"
                                                        :style="`width: ${getPowerConsumpingPercentage(0)};`"
                                                        aria-valuenow="34" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                                <div class="d-flex">
                                                    示範場域
                                                    <span class="d-inline-block ml-auto">{{getPowerConsumping(1)}}
                                                        KW</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-success-500" role="progressbar"
                                                        :style="`width: ${getPowerConsumpingPercentage(1)};`"
                                                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                                <div class="d-flex mt-2">
                                                    臺灣智駕測試實驗室(尚未連線)
                                                    <span class="d-inline-block ml-auto">N/A</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-fusion-400" role="progressbar"
                                                        style="width: 0%;" aria-valuenow="0" aria-valuemin="0"
                                                        aria-valuemax="100"></div>
                                                </div>
                                                <div class="d-flex">
                                                    智慧綠能循環住宅園區(尚未連線)
                                                    <span class="d-inline-block ml-auto">N/A</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-danger-100" role="progressbar"
                                                        style="width: 0%;" aria-valuenow="0" aria-valuemin="0"
                                                        aria-valuemax="100"></div>
                                                </div>
                                                <div class="d-flex">
                                                    智慧綠能循環住宅園區(尚未連線)
                                                    <span class="d-inline-block ml-auto">N/A</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-success-500" role="progressbar"
                                                        style="width: 0%;" aria-valuenow="0" aria-valuemin="0"
                                                        aria-valuemax="100"></div>
                                                </div>
                                                <div class="d-flex">
                                                    會展中心(尚未連線)
                                                    <span class="d-inline-block ml-auto">N/A</span>
                                                </div>
                                                <div class="progress progress-sm mb-3">
                                                    <div class="progress-bar bg-success-500" role="progressbar"
                                                        style="width: 0%;" aria-valuenow="0" aria-valuemin="0"
                                                        aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row  match-height">
                        <div class="col-lg-4">
                            <div id="panel-2" class="panel panel-locked" data-panel-sortable data-panel-collapsed
                                data-panel-close>
                                <div class="panel-hdr">
                                    <h2>
                                        綠能滲透率 <span class="fw-300"><i></i></span>
                                    </h2>
                                </div>
                                <div class="panel-container show">
                                    <div class="panel-content p-0">
                                        <div v-if="dataReady" class="row row-grid no-gutters">
                                            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div
                                                        class="d-inline-flex align-items-center justify-content-center color-primary-800">
                                                        {{getGreenPercentageStr(0)}}</div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        聯合研究中心
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div
                                                        class="d-inline-flex align-items-center justify-content-center color-primary-800">
                                                        {{getGreenPercentageStr(1)}}</div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        示範場域
                                                    </span>
                                                </div>
                                            </div>
                                            <!-- <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div class="js-easy-pie-chart color-primary-300 position-relative d-inline-flex align-items-center justify-content-center"
                                                        data-percent="0" data-piesize="50" data-linewidth="5"
                                                        data-linecap="butt">
                                                        <div
                                                            class="d-flex flex-column align-items-center justify-content-center position-absolute pos-left pos-right pos-top pos-bottom fw-300 fs-lg">
                                                            <span class="js-percent d-block text-dark"></span>
                                                        </div>
                                                    </div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        臺灣智駕測試實驗室(尚未連線)
                                                        <i class="fal fa-caret-up color-danger-500 ml-1"></i>
                                                    </span>
                                                </div>
                                            </div> -->
                                            <!-- <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div class="js-easy-pie-chart color-info-500 position-relative d-inline-flex align-items-center justify-content-center"
                                                        data-percent="0" data-piesize="50" data-linewidth="5"
                                                        data-linecap="butt">
                                                        <div
                                                            class="d-flex flex-column align-items-center justify-content-center position-absolute pos-left pos-right pos-top pos-bottom fw-300 fs-lg">
                                                            <span class="js-percent d-block text-dark"></span>
                                                        </div>
                                                    </div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        智慧綠能循環住宅園區(尚未連線)
                                                        <i class="fal fa-caret-up color-success-500 ml-1"></i>
                                                    </span>
                                                </div>
                                            </div> -->
                                            <!-- <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div class="js-easy-pie-chart color-fusion-500 position-relative d-inline-flex align-items-center justify-content-center"
                                                        data-percent="0" data-piesize="50" data-linewidth="5"
                                                        data-linecap="butt">
                                                        <div
                                                            class="d-flex flex-column align-items-center justify-content-center position-absolute pos-left pos-right pos-top pos-bottom fw-300 fs-lg">
                                                            <span class="js-percent d-block text-dark"></span>
                                                        </div>
                                                    </div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        中研院南部院區(尚未連線)
                                                        <i class="fal fa-caret-down color-success-500 ml-1"></i>
                                                    </span>
                                                </div>
                                            </div>  -->
                                            <!-- <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
                                                <div class="px-3 py-2 d-flex align-items-center">
                                                    <div class="js-easy-pie-chart color-primary-300 position-relative d-inline-flex align-items-center justify-content-center"
                                                        data-percent="0" data-piesize="50" data-linewidth="5"
                                                        data-linecap="butt" data-scalelength="0">
                                                        <div
                                                            class="d-flex flex-column align-items-center justify-content-center position-absolute pos-left pos-right pos-top pos-bottom fw-300 fs-lg">
                                                            <span class="js-percent d-block text-dark"></span>
                                                        </div>
                                                    </div>
                                                    <span class="d-inline-block ml-2 text-muted">
                                                        會展中心 (尚未連線)
                                                        <i class="fal fa-caret-up color-danger-500 ml-1"></i>
                                                    </span>
                                                </div>
                                            </div> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <b-row>
                                <b-col cols="4" class="text-center">
                                    <b-img :src="weatherUrl" fluid />
                                </b-col>
                                <b-col cols="8">{{ weatherForecast }}</b-col>
                            </b-row>
                        </div>
                        <div class="col-lg-8">
                            <div id="panel-2" class="panel" class="panel panel-locked" data-panel-lock="false"
                                data-panel-close="false" data-panel-fullscreen="false" data-panel-collapsed="false"
                                data-panel-color="false" data-panel-locked="false" data-panel-refresh="false"
                                data-panel-reset="false">
                                <div class="panel-hdr">
                                    <h2>
                                        <strong>用電量資訊</strong>
                                    </h2>
                                </div>
                                <div class="panel-container show">
                                    <div class="panel-content">
                                        <b-row class="match-height">
                                            <b-col lg="4" class="text-center">
                                                <b-img class="p-1" src="img/map.png" fluid />
                                            </b-col>
                                            <b-col lg="8">
                                                <div class="pt-2">
                                                    <b-table :items="items" :fields="fields" bordered small
                                                        table-variant="success" />
                                                </div>
                                            </b-col>
                                        </b-row>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <!-- this overlay is activated only when mobile menu is triggered -->
                <div class="page-content-overlay" data-action="toggle" data-class="mobile-nav-on"></div>
                <!-- END Page Content -->
                <!-- BEGIN Color profile -->
                <!-- this area is hidden and will not be seen on screens or screen readers -->
                <!-- we use this only for CSS color refernce for JS stuff -->
                <p id="js-color-profile" class="d-none">
                    <span class="color-primary-50"></span>
                    <span class="color-primary-100"></span>
                    <span class="color-primary-200"></span>
                    <span class="color-primary-300"></span>
                    <span class="color-primary-400"></span>
                    <span class="color-primary-500"></span>
                    <span class="color-primary-600"></span>
                    <span class="color-primary-700"></span>
                    <span class="color-primary-800"></span>
                    <span class="color-primary-900"></span>
                    <span class="color-info-50"></span>
                    <span class="color-info-100"></span>
                    <span class="color-info-200"></span>
                    <span class="color-info-300"></span>
                    <span class="color-info-400"></span>
                    <span class="color-info-500"></span>
                    <span class="color-info-600"></span>
                    <span class="color-info-700"></span>
                    <span class="color-info-800"></span>
                    <span class="color-info-900"></span>
                    <span class="color-danger-50"></span>
                    <span class="color-danger-100"></span>
                    <span class="color-danger-200"></span>
                    <span class="color-danger-300"></span>
                    <span class="color-danger-400"></span>
                    <span class="color-danger-500"></span>
                    <span class="color-danger-600"></span>
                    <span class="color-danger-700"></span>
                    <span class="color-danger-800"></span>
                    <span class="color-danger-900"></span>
                    <span class="color-warning-50"></span>
                    <span class="color-warning-100"></span>
                    <span class="color-warning-200"></span>
                    <span class="color-warning-300"></span>
                    <span class="color-warning-400"></span>
                    <span class="color-warning-500"></span>
                    <span class="color-warning-600"></span>
                    <span class="color-warning-700"></span>
                    <span class="color-warning-800"></span>
                    <span class="color-warning-900"></span>
                    <span class="color-success-50"></span>
                    <span class="color-success-100"></span>
                    <span class="color-success-200"></span>
                    <span class="color-success-300"></span>
                    <span class="color-success-400"></span>
                    <span class="color-success-500"></span>
                    <span class="color-success-600"></span>
                    <span class="color-success-700"></span>
                    <span class="color-success-800"></span>
                    <span class="color-success-900"></span>
                    <span class="color-fusion-50"></span>
                    <span class="color-fusion-100"></span>
                    <span class="color-fusion-200"></span>
                    <span class="color-fusion-300"></span>
                    <span class="color-fusion-400"></span>
                    <span class="color-fusion-500"></span>
                    <span class="color-fusion-600"></span>
                    <span class="color-fusion-700"></span>
                    <span class="color-fusion-800"></span>
                    <span class="color-fusion-900"></span>
                </p>
                <!-- END Color profile -->
            </div>
        </div>
    </div>
    <!-- END Page Wrapper -->
    <!-- BEGIN Quick Menu -->
    <!-- to add more items, please make sure to change the variable '$menu-items: number;' in your _page-components-shortcut.scss -->
    <nav class="shortcut-menu d-none d-sm-block">
        <input type="checkbox" class="menu-open" name="menu-open" id="menu_open" />
        <label for="menu_open" class="menu-open-button ">
            <span class="app-shortcut-icon d-block"></span>
        </label>
        <a href="#" class="menu-item btn" data-toggle="tooltip" data-placement="left" title="Scroll Top">
            <i class="fal fa-arrow-up"></i>
        </a>
        <a href="page_login.html" class="menu-item btn" data-toggle="tooltip" data-placement="left" title="Logout">
            <i class="fal fa-sign-out"></i>
        </a>
        <a href="#" class="menu-item btn" data-action="app-fullscreen" data-toggle="tooltip" data-placement="left"
            title="Full Screen">
            <i class="fal fa-expand"></i>
        </a>
        <a href="#" class="menu-item btn" data-action="app-print" data-toggle="tooltip" data-placement="left"
            title="Print page">
            <i class="fal fa-print"></i>
        </a>
        <a href="#" class="menu-item btn" data-action="app-voice" data-toggle="tooltip" data-placement="left"
            title="Voice command">
            <i class="fal fa-microphone"></i>
        </a>
    </nav>
    <!-- END Quick Menu -->
    <!-- base vendor bundle: 
			 DOC: if you remove pace.js from core please note on Internet Explorer some CSS animations may execute before a page is fully loaded, resulting 'jump' animations 
						+ pace.js (recommended)
						+ jquery.js (core)
						+ jquery-ui-cust.js (core)
						+ popper.js (core)
						+ bootstrap.js (core)
						+ slimscroll.js (extension)
						+ app.navigation.js (core)
						+ ba-throttle-debounce.js (core)
						+ waves.js (extension)
						+ smartpanels.js (extension)
						+ src/../jquery-snippets.js (core) -->
    <script src="js/vendors.bundle.js"></script>
    <script src="js/app.bundle.js"></script>
    <script type="text/javascript">
        /* Activate smart panels */
        $('#js-page-content').smartPanel();

    </script>
    <!-- The order of scripts is irrelevant. Please check out the plugin pages for more details about these plugins below: -->
    <script src="js/statistics/sparkline/sparkline.bundle.js"></script>
    <script src="js/statistics/easypiechart/easypiechart.bundle.js"></script>
    <script src="js/statistics/flot/flot.bundle.js"></script>
    <script src="js/miscellaneous/jqvmap/jqvmap.bundle.js"></script>
    <script>
        moment.locale('zh_tw');
        Highcharts.setOptions({
            lang: {
                contextButtonTitle: '圖表功能表',
                downloadJPEG: '下載JPEG',
                downloadPDF: '下載PDF',
                downloadPNG: '下載PNG',
                downloadSVG: '下載SVG',
                downloadCSV: '下載CSV',
                downloadXLS: '下載XLS',
                drillUpText: '回到{series.name}.',
                noData: '無資料',
                months: [
                    '1月',
                    '2月',
                    '3月',
                    '4月',
                    '5月',
                    '6月',
                    '7月',
                    '8月',
                    '9月',
                    '10月',
                    '11月',
                    '12月',
                ],
                printChart: '列印圖表',
                resetZoom: '重設放大區間',
                resetZoomTitle: '回到原圖大小',
                shortMonths: [
                    '1月',
                    '2月',
                    '3月',
                    '4月',
                    '5月',
                    '6月',
                    '7月',
                    '8月',
                    '9月',
                    '10月',
                    '11月',
                    '12月',
                ],
                viewFullscreen: '全螢幕檢視',
                viewData: '檢視資料表',
                weekdays: [
                    '星期日',
                    '星期一',
                    '星期二',
                    '星期三',
                    '星期四',
                    '星期五',
                    '星期六',
                ],
            },
        });

        new Vue({
            //this targets the div id app
            el: '#js-page-content',
            data() {
                return {
                    current: moment().format("lll"),
                    forecast: "降雨機率15%",
                    fields: [
                        {
                            key: "no",
                            label: "編號",
                            sortable: true
                        },
                        {
                            key: "name",
                            label: "名稱",
                            sortable: true
                        },
                        {
                            key: "deviceCapacity",
                            label: "裝置容量",
                            sortable: true
                        },
                        {
                            key: "contractCapacity",
                            label: "契約容量",
                            sortable: true
                        },
                    ],
                    items: [
                        {
                            no: "1",
                            name: "臺灣智駕測試實驗室",
                            deviceCapacity: "37.515 KW",
                            contractCapacity: "150 KW"

                        },
                        {
                            no: "2",
                            name: "智慧綠能循環住宅園區",
                            deviceCapacity: "200.2 KW",
                            contractCapacity: "61 KW"

                        },
                        /* {
                            no: "A",
                            name: "會展中心",
                            deviceCapacity: "687 KW",
                            contractCapacity: "128 KW"

                        },
                        {
                            no: "B",
                            name: "產業專用區",
                            deviceCapacity: "N/A",
                            contractCapacity: "N/A"

                        }, */
                        {
                            no: "C",
                            name: "聯合研究中心",
                            deviceCapacity: "688 KW",
                            contractCapacity: "2,750 KW"

                        },
                        {
                            no: "D",
                            name: "示範場域",
                            deviceCapacity: "1,041 KW",
                            contractCapacity: "1,000 KW"
                        },
                        {
                            no: "E",
                            name: "中研院南部院區",
                            deviceCapacity: "477.6 KW",
                            contractCapacity: "2,400 KW"
                        },
                    ],
                    weatherForecast: '',
                    weatherUrl: '',
                    powerSummary: [],
                    dataReady: false
                }
            },
            computed: {
                totalGenerating() {
                    let sum = 0;
                    this.powerSummary.forEach(p => sum += p.generating);
                    return sum.toFixed(0);
                },
                totalConsuming() {
                    let sum = 0;
                    this.powerSummary.forEach(p => sum += p.consuming);
                    return sum.toFixed(0);
                }
            },
            async mounted() {
                await this.getWeatherReport();
                await this.getPowerSummary();
                await this.getRealtimeChart();
                this.dataReady = true;
            },
            methods: {
                async getWeatherReport() {
                    try {
                        let url = `${location.protocol}//${location.host}/WeatherReport`
                        const resp = await axios.get(url);
                        if (resp.status === 200) {
                            this.weatherForecast = '';
                            let weatherElements =
                                resp.data.records.locations[0].location[0].weatherElement;
                            let desc = weatherElements.find(
                                p => p.elementName === 'WeatherDescription',
                            );
                            if (desc !== undefined) {
                                this.weatherForecast += desc.time[0].elementValue[0].value;
                            }

                            let wx = weatherElements.find(p => p.elementName === 'Wx');
                            if (wx !== undefined) {
                                this.weatherUrl = `https://www.cwb.gov.tw/V8/assets/img/weather_icons/weathers/svg_icon/day/${wx.time[0].elementValue[1].value}.svg`;
                            }
                        }
                    } catch (err) {
                        throw new Error('fail to get weather report');
                    }
                },
                async getPowerSummary() {
                    try {
                        const resp = await axios.get('/RealtimeStatus')
                        if (resp.status === 200) {
                            this.powerSummary = resp.data.summary;
                            console.log(this.powerSummary)
                        }
                    } catch (err) {
                        throw new Error('fail to get power summary')
                    }
                },
                getPowerConsumping(idx) {
                    if (idx < this.powerSummary.length) {
                        return `${this.powerSummary[idx].consuming.toFixed(3)}`
                    } else
                        return ''
                },
                getPowerConsumpingPercentage(idx) {
                    if (idx < this.powerSummary.length) {
                        let max = 1;
                        if (idx === 0)
                            max = 688;
                        else
                            max = 1041;

                        let ret = `${(this.powerSummary[idx].consuming * 100 / max).toFixed(0)}%`
                        console.log(`ret=${ret}`);
                        return `${(this.powerSummary[idx].consuming * 100 / max).toFixed(0)}%`
                    } else
                        return '0%'
                },
                getPowerGenerating(idx) {
                    if (idx < this.powerSummary.length) {
                        return `${this.powerSummary[idx].generating}`
                    } else
                        return ''
                },
                getGreenPercentage(idx) {
                    if (idx < this.powerSummary.length) {
                        if (this.powerSummary[idx].generating >= this.powerSummary[idx].consuming)
                            return 100;
                        else
                            return 100 * this.powerSummary[idx].generating / this.powerSummary[idx].consuming;
                    } else
                        return 0;
                },
                getGreenPercentageStr(idx) {
                    if (idx < this.powerSummary.length) {
                        if (this.powerSummary[idx].generating >= this.powerSummary[idx].consuming)
                            return "100%";
                        else
                            return `${(100 * this.powerSummary[idx].generating / this.powerSummary[idx].consuming).toFixed(0)}%`;
                    } else
                        return "0%";
                },
                async getRealtimeChart() {
                    try {
                        let monitors = ['RdCenter', 'ITRI'];
                        let monitorTypes = ['generating'];
                        let start = moment().subtract(1, 'days').valueOf();
                        let end = moment().valueOf();
                        const url = `/HistoryTrend/${monitors.join(':')}/${monitorTypes.join(':')}/Min/${start}/${end}`;
                        console.log(url)
                        const res = await axios.get(url);
                        const ret = res.data;
                        ret.chart = {
                            type: "column",
                            zoomType: 'x',
                            panning: true,
                            panKey: 'shift',
                            alignTicks: false,
                        };

                        ret.legend = { enabled: true };
                        ret.credits = {
                            enabled: false,
                            href: 'http://www.wecc.com.tw/',
                        };
                        ret.xAxis.type = 'datetime';
                        ret.xAxis.dateTimeLabelFormats = {
                            day: '%b%e日',
                            week: '%b%e日',
                            month: '%y年%b',
                        };

                        ret.time = {
                            timezoneOffset: -480,
                        };

                        ret.tooltip = {
                            pointFormat: '{series.name}: {point.y}KW<br/>加總: {point.stackTotal}KW',
                            valueDecimals: 2
                        };
                        ret.yAxis.min = 0;
                        ret.yAxis.stackLabels = {
                            enabled: true,
                            style: {
                                fontWeight: 'bold',
                                color: ( // theme
                                    Highcharts.defaultOptions.title.style &&
                                    Highcharts.defaultOptions.title.style.color
                                ) || 'gray'
                            }
                        };
                        ret.plotOptions = {
                            column: {
                                stacking: 'normal',
                            }
                        };


                        Highcharts.chart('chart_container', ret);
                    } catch (err) {
                        throw new Error("failed to get realtime chart!");
                    }
                },
            },
        });
    </script>
</body>

</html>