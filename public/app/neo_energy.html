<!DOCTYPE html>
<!-- 
Template Name:  SmartAdmin Responsive WebApp - Template build with Twitter Bootstrap 4
Version: 4.5.1
Author: Sunnyat A.
Website: http://gootbootstrap.com
Purchase: https://wrapbootstrap.com/theme/smartadmin-responsive-webapp-WB0573SK0?ref=myorange
License: You must have a valid license purchased only from wrapbootstrap.com (link above) in order to legally use this theme for your project.
-->
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>
        再生能源 - - 沙崙科學園區 v4.5.1
    </title>
    <meta name="description" content="再生能源">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, minimal-ui">
    <!-- Call App Mode on ios devices -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Remove Tap Highlight on Windows Phone IE -->
    <meta name="msapplication-tap-highlight" content="no">
    <!-- base css -->
    <link id="vendorsbundle" rel="stylesheet" media="screen, print" href="css/vendors.bundle.css">
    <link id="appbundle" rel="stylesheet" media="screen, print" href="css/app.bundle.css">
    <link id="mytheme" rel="stylesheet" media="screen, print" href="#">
    <link id="myskin" rel="stylesheet" media="screen, print" href="css/skins/skin-master.css">
    <!-- Place favicon.ico in the root directory -->
    <link rel="apple-touch-icon" sizes="180x180" href="img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon/favicon-32x32.png">
    <link rel="mask-icon" href="img/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="stylesheet" media="screen, print" href="css/datagrid/datatables/datatables.bundle.css">
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.24.0/axios.min.js"
        integrity="sha512-u9akINsQsAkG9xjc1cnGF4zw5TFDwkxuc9vUp5dltDWYCSmyd0meygbvgXrlc/z7/o4a19Fb5V0OUE58J7dcyw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment-with-locales.min.js"
        integrity="sha512-LGXaggshOkD/at6PFNcp2V2unf9LzFq6LE+sChH7ceMTDP0g2kn6Vxwgg7wkPP7AAtX+lmPqPdxB47A0Nz0cMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
</head>
<!-- BEGIN Body -->
<!-- Possible Classes

		* 'header-function-fixed'         - header is in a fixed at all times
		* 'nav-function-fixed'            - left panel is fixed
		* 'nav-function-minify'			  - skew nav to maximize space
		* 'nav-function-hidden'           - roll mouse on edge to reveal
		* 'nav-function-top'              - relocate left pane to top
		* 'mod-main-boxed'                - encapsulates to a container
		* 'nav-mobile-push'               - content pushed on menu reveal
		* 'nav-mobile-no-overlay'         - removes mesh on menu reveal
		* 'nav-mobile-slide-out'          - content overlaps menu
		* 'mod-bigger-font'               - content fonts are bigger for readability
		* 'mod-high-contrast'             - 4.5:1 text contrast ratio
		* 'mod-color-blind'               - color vision deficiency
		* 'mod-pace-custom'               - preloader will be inside content
		* 'mod-clean-page-bg'             - adds more whitespace
		* 'mod-hide-nav-icons'            - invisible navigation icons
		* 'mod-disable-animation'         - disables css based animations
		* 'mod-hide-info-card'            - hides info card from left panel
		* 'mod-lean-subheader'            - distinguished page header
		* 'mod-nav-link'                  - clear breakdown of nav links

		>>> more settings are described inside documentation page >>>
	-->

<body class="mod-bg-1 mod-nav-link ">
    <!-- DOC: script to save and load page settings -->
    <script>
        /**
         *	This script should be placed right after the body tag for fast execution 
         *	Note: the script is written in pure javascript and does not depend on thirdparty library
         **/
        'use strict';

        var classHolder = document.getElementsByTagName("BODY")[0],
            /** 
             **/
            themeSettings = {
                "themeOptions": "mod-bg-1 mod-nav-link nav-mobile-push mod-bigger-font",
                "themeURL": "css/themes/cust-theme-13.css"
            },
            themeURL = themeSettings.themeURL || '',
            themeOptions = themeSettings.themeOptions || '';
        /** 
         * Load theme options
         **/
        if (themeSettings.themeOptions) {
            classHolder.className = themeSettings.themeOptions;
            console.log("%c✔ Theme settings loaded", "color: #148f32");
        }
        else {
            console.log("%c✔ Heads up! Theme settings is empty or does not exist, loading default settings...", "color: #ed1c24");
        }
        if (themeSettings.themeURL && !document.getElementById('mytheme')) {
            var cssfile = document.createElement('link');
            cssfile.id = 'mytheme';
            cssfile.rel = 'stylesheet';
            cssfile.href = themeURL;
            document.getElementsByTagName('head')[0].appendChild(cssfile);

        }
        else if (themeSettings.themeURL && document.getElementById('mytheme')) {
            document.getElementById('mytheme').href = themeSettings.themeURL;
        }
        /** 
         * Save to localstorage 
         **/
        var saveSettings = function () {
            themeSettings.themeOptions = String(classHolder.className).split(/[^\w-]+/).filter(function (item) {
                return /^(nav|header|footer|mod|display)-/i.test(item);
            }).join(' ');
            if (document.getElementById('mytheme')) {
                themeSettings.themeURL = document.getElementById('mytheme').getAttribute("href");
            };
            localStorage.setItem('themeSettings', JSON.stringify(themeSettings));
        }
        /** 
         * Reset settings
         **/
        var resetSettings = function () {
            localStorage.setItem("themeSettings", "");
        }

    </script>
    <!-- BEGIN Page Wrapper -->
    <div class="page-wrapper">
        <div class="page-inner">
            <!-- BEGIN Left Aside -->
            <aside class="page-sidebar">
                <div class="page-logo">
                    <img src="img/logo.svg" alt="沙崙科學園區" aria-roledescription="logo">
                    <span class="page-logo-text text-center">沙崙智慧綠能科學城<br />電能管理系統資訊平臺</span>
                    <span class="position-absolute text-white opacity-50 small pos-top pos-right mr-2 mt-n2"></span>
                </div>
                <!-- BEGIN PRIMARY NAVIGATION -->
                <nav id="js-primary-nav" class="primary-nav" role="navigation">
                    <div class="nav-filter">
                        <div class="position-relative">
                            <input type="text" id="nav_filter_input" placeholder="Filter menu" class="form-control"
                                tabindex="0">
                            <a href="#" onclick="return false;" class="btn-primary btn-search-close js-waves-off"
                                data-action="toggle" data-class="list-filter-active" data-target=".page-sidebar">
                                <i class="fal fa-chevron-up"></i>
                            </a>
                        </div>
                    </div>
                    <div class="info-card">
                        <img src="img/card-backgrounds/cover-2-lg.png" class="cover" alt="cover">
                        <a href="#" onclick="return false;" class="pull-trigger-btn" data-action="toggle"
                            data-class="list-filter-active" data-target=".page-sidebar" data-focus="nav_filter_input">
                            <i class="fal fa-angle-down"></i>
                        </a>
                    </div>
                    <ul id="js-nav-menu" class="nav-menu">
                        <li class="active open">
                            <a href="#" title="" data-filter-tags="">
                                <i class="fal fa-info-circle"></i>
                                <span class="nav-link-text" data-i18n="nav."></span>
                            </a>
                            <ul>
                                <li>
                                    <a href="index.html" title="首頁" data-filter-tags=" 首頁">
                                        <span class="nav-link-text" data-i18n="nav._首頁">首頁</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="smart_grid.html" title="區域電力資訊" data-filter-tags=" 區域電力資訊">
                                        <span class="nav-link-text" data-i18n="nav._區域電力資訊">區域電力資訊</span>
                                    </a>
                                </li>
                                <li class="active">
                                    <a href="neo_energy.html" title="再生能源" data-filter-tags=" 再生能源">
                                        <span class="nav-link-text" data-i18n="nav._再生能源">再生能源</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="energy_saving.html" title="節電成效" data-filter-tags=" 節電成效">
                                        <span class="nav-link-text" data-i18n="nav._節電成效">節電成效</span>
                                    </a>
                                </li>
                                <!--  <li>
                                    <a href="requirement_management.html" title="需量調控" data-filter-tags=" 需量調控">
                                        <span class="nav-link-text" data-i18n="nav._需量調控">需量調控</span>
                                    </a>
                                </li> -->
                                <li>
                                    <a href="links.html" title="友善連結" data-filter-tags=" 友善連結">
                                        <span class="nav-link-text" data-i18n="nav._友善連結">友善連結</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <div class="filter-message js-filter-message bg-success-600"></div>
                </nav>
                <!-- END PRIMARY NAVIGATION -->
                <!-- NAV FOOTER -->
            </aside>
            <!-- END Left Aside -->
            <div class="page-content-wrapper">
                <!-- BEGIN Page Header -->
                <header class="page-header" role="banner">
                    <!-- we need this logo when user switches to nav-function-top -->
                    <div class="page-logo">
                        <a href="#" class="page-logo-link press-scale-down d-flex align-items-center position-relative"
                            data-toggle="modal" data-target="#modal-shortcut">
                            <img src="img/logo.svg" alt="沙崙科學園區" aria-roledescription="logo">
                            <span class="page-logo-text mr-1">沙崙科學園區</span>
                            <span
                                class="position-absolute text-white opacity-50 small pos-top pos-right mr-2 mt-n2"></span>
                            <i class="fal fa-angle-down d-inline-block ml-1 fs-lg color-primary-300"></i>
                        </a>
                    </div>
                    <!-- DOC: nav menu layout change shortcut -->
                    <div class="hidden-md-down dropdown-icon-menu position-relative">
                        <a href="#" class="header-btn btn js-waves-off" data-action="toggle"
                            data-class="nav-function-hidden" title="Hide Navigation">
                            <i class="ni ni-menu"></i>
                        </a>
                        <ul>
                            <li>
                                <a href="#" class="btn js-waves-off" data-action="toggle"
                                    data-class="nav-function-minify" title="Minify Navigation">
                                    <i class="ni ni-minify-nav"></i>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="btn js-waves-off" data-action="toggle"
                                    data-class="nav-function-fixed" title="Lock Navigation">
                                    <i class="ni ni-lock-nav"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!-- DOC: mobile button appears during mobile width -->
                    <div class="hidden-lg-up">
                        <a href="#" class="header-btn btn press-scale-down" data-action="toggle"
                            data-class="mobile-nav-on">
                            <i class="ni ni-menu"></i>
                        </a>
                    </div>
                    <div class="search">
                        <form class="app-forms hidden-xs-down" role="search" action="page_search.html"
                            autocomplete="off">
                            <input type="text" id="search-field" placeholder="" class="form-control" tabindex="1">
                            <a href="#" onclick="return false;" class="btn-danger btn-search-close js-waves-off d-none"
                                data-action="toggle" data-class="mobile-search-on">
                                <i class="fal fa-times"></i>
                            </a>
                        </form>
                    </div>
                    <div class="ml-auto d-flex">
                        <!-- activate app search icon (mobile) -->
                        <div class="hidden-sm-up">
                            <a href="#" class="header-icon" data-action="toggle" data-class="mobile-search-on"
                                data-focus="search-field" title="Search">
                                <i class="fal fa-search"></i>
                            </a>
                        </div>
                        <!-- app settings -->
                        <div class="hidden-md-down">
                            <a href="#" class="header-icon" data-toggle="modal" data-target=".js-modal-settings">
                                <i class="fal fa-cog"></i>
                            </a>
                        </div>
                        <!-- app shortcuts -->
                        <!-- app notification -->
                        <!-- app user menu -->
                        <img src="img/demo/avatars/logo.svg" class="mr-2 profile-image" alt="智慧綠能科學城">
                    </div>
                </header>
                <!-- END Page Header -->
                <!-- BEGIN Page Content -->
                <!-- the #js-page-content id is needed for some plugins to initialize -->
                <main id="js-page-content" role="main" class="page-content">
                    <div class="subheader">
                        <h1 class="subheader-title">
                            <i class='subheader-icon fal fa-chart-area'></i> 再生能源 <span class='fw-300'></span>
                        </h1>
                        <div class="subheader-block d-lg-flex align-items-center">
                            <div class="d-flex mr-4">
                                <div class="mr-2">
                                    <span class="peity-donut"
                                        data-peity="{ &quot;fill&quot;: [&quot;#967bbd&quot;, &quot;#ccbfdf&quot;],  &quot;innerRadius&quot;: 14, &quot;radius&quot;: 20 }">7/10</span>
                                </div>
                                <div>
                                    <label class="fs-sm mb-0 mt-2 mt-md-0">綠能滲透率</label>
                                    <h4 class="font-weight-bold mb-0">{{ greenPercent }}</h4>
                                </div>
                            </div>
                            <div class="d-flex mr-0">
                                <div class="mr-2">
                                    <span class="peity-donut"
                                        data-peity="{ &quot;fill&quot;: [&quot;#2196F3&quot;, &quot;#9acffa&quot;],  &quot;innerRadius&quot;: 14, &quot;radius&quot;: 20 }">3/10</span>
                                </div>
                                <div>
                                    <label class="fs-sm mb-0 mt-2 mt-md-0">即時發電裝置容量率</label>
                                    <h4 class="font-weight-bold mb-0">{{ devicePercent }}</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <b-card no-body>
                        <b-tabs card>
                            <b-tab title="臺灣智駕測試實驗室(N/A)" disabled>
                                <b-card-text>Tab contents 1</b-card-text>
                            </b-tab>
                            <b-tab title="智慧綠能循環住宅園區(N/A)" disabled>
                                <b-card-text>Tab contents 2</b-card-text>
                            </b-tab>
                            <b-tab title="聯合研究中心" active>
                                <b-row>
                                    <b-col cols="12" lg="6">
                                        <div id="RdCenter_sum"></div>
                                    </b-col>
                                    <b-col cols="12" lg="6">
                                        <div id="RdCenter_greenpercent"></div>
                                    </b-col>
                                </b-row>
                            </b-tab>
                            <b-tab title="示範場域">
                                <b-row>
                                    <b-col cols="12" lg="6">
                                        <div id="ITRI_sum"></div>
                                    </b-col>
                                    <b-col cols="12" lg="6">
                                        <div id="ITRI_greenpercent"></div>
                                    </b-col>
                                </b-row>
                            </b-tab>
                            <b-tab title="中研院南部院區(N/A)" disabled>
                                <b-card-text>Tab contents 2</b-card-text>
                            </b-tab>
                        </b-tabs>
                    </b-card>
                </main>
                <!-- this overlay is activated only when mobile menu is triggered -->
                <div class="page-content-overlay" data-action="toggle" data-class="mobile-nav-on"></div>
                <!-- END Page Content -->
                <!-- this area is hidden and will not be seen on screens or screen readers -->
                <!-- we use this only for CSS color refernce for JS stuff -->
                <p id="js-color-profile" class="d-none">
                    <span class="color-primary-50"></span>
                    <span class="color-primary-100"></span>
                    <span class="color-primary-200"></span>
                    <span class="color-primary-300"></span>
                    <span class="color-primary-400"></span>
                    <span class="color-primary-500"></span>
                    <span class="color-primary-600"></span>
                    <span class="color-primary-700"></span>
                    <span class="color-primary-800"></span>
                    <span class="color-primary-900"></span>
                    <span class="color-info-50"></span>
                    <span class="color-info-100"></span>
                    <span class="color-info-200"></span>
                    <span class="color-info-300"></span>
                    <span class="color-info-400"></span>
                    <span class="color-info-500"></span>
                    <span class="color-info-600"></span>
                    <span class="color-info-700"></span>
                    <span class="color-info-800"></span>
                    <span class="color-info-900"></span>
                    <span class="color-danger-50"></span>
                    <span class="color-danger-100"></span>
                    <span class="color-danger-200"></span>
                    <span class="color-danger-300"></span>
                    <span class="color-danger-400"></span>
                    <span class="color-danger-500"></span>
                    <span class="color-danger-600"></span>
                    <span class="color-danger-700"></span>
                    <span class="color-danger-800"></span>
                    <span class="color-danger-900"></span>
                    <span class="color-warning-50"></span>
                    <span class="color-warning-100"></span>
                    <span class="color-warning-200"></span>
                    <span class="color-warning-300"></span>
                    <span class="color-warning-400"></span>
                    <span class="color-warning-500"></span>
                    <span class="color-warning-600"></span>
                    <span class="color-warning-700"></span>
                    <span class="color-warning-800"></span>
                    <span class="color-warning-900"></span>
                    <span class="color-success-50"></span>
                    <span class="color-success-100"></span>
                    <span class="color-success-200"></span>
                    <span class="color-success-300"></span>
                    <span class="color-success-400"></span>
                    <span class="color-success-500"></span>
                    <span class="color-success-600"></span>
                    <span class="color-success-700"></span>
                    <span class="color-success-800"></span>
                    <span class="color-success-900"></span>
                    <span class="color-fusion-50"></span>
                    <span class="color-fusion-100"></span>
                    <span class="color-fusion-200"></span>
                    <span class="color-fusion-300"></span>
                    <span class="color-fusion-400"></span>
                    <span class="color-fusion-500"></span>
                    <span class="color-fusion-600"></span>
                    <span class="color-fusion-700"></span>
                    <span class="color-fusion-800"></span>
                    <span class="color-fusion-900"></span>
                </p>
                <!-- END Color profile -->
            </div>
        </div>
    </div>
    <!-- END Page Wrapper -->
    <!-- base vendor bundle: 
			 DOC: if you remove pace.js from core please note on Internet Explorer some CSS animations may execute before a page is fully loaded, resulting 'jump' animations 
						+ pace.js (recommended)
						+ jquery.js (core)
						+ jquery-ui-cust.js (core)
						+ popper.js (core)
						+ bootstrap.js (core)
						+ slimscroll.js (extension)
						+ app.navigation.js (core)
						+ ba-throttle-debounce.js (core)
						+ waves.js (extension)
						+ smartpanels.js (extension)
						+ src/../jquery-snippets.js (core) -->
    <script src="js/vendors.bundle.js"></script>
    <script src="js/app.bundle.js"></script>
    <script type="text/javascript">
        /* Activate smart panels */
        $('#js-page-content').smartPanel();

    </script>
    <!-- The order of scripts is irrelevant. Please check out the plugin pages for more details about these plugins below: -->
    <script src="js/statistics/sparkline/sparkline.bundle.js"></script>
    <script src="js/statistics/peity/peity.bundle.js"></script>
    <script src="js/statistics/flot/flot.bundle.js"></script>
    <script src="js/statistics/easypiechart/easypiechart.bundle.js"></script>
    <script>
        moment.locale('zh_tw');
        Highcharts.setOptions({
            lang: {
                contextButtonTitle: '圖表功能表',
                downloadJPEG: '下載JPEG',
                downloadPDF: '下載PDF',
                downloadPNG: '下載PNG',
                downloadSVG: '下載SVG',
                downloadCSV: '下載CSV',
                downloadXLS: '下載XLS',
                drillUpText: '回到{series.name}.',
                noData: '無資料',
                months: [
                    '1月',
                    '2月',
                    '3月',
                    '4月',
                    '5月',
                    '6月',
                    '7月',
                    '8月',
                    '9月',
                    '10月',
                    '11月',
                    '12月',
                ],
                printChart: '列印圖表',
                resetZoom: '重設放大區間',
                resetZoomTitle: '回到原圖大小',
                shortMonths: [
                    '1月',
                    '2月',
                    '3月',
                    '4月',
                    '5月',
                    '6月',
                    '7月',
                    '8月',
                    '9月',
                    '10月',
                    '11月',
                    '12月',
                ],
                viewFullscreen: '全螢幕檢視',
                viewData: '檢視資料表',
                weekdays: [
                    '星期日',
                    '星期一',
                    '星期二',
                    '星期三',
                    '星期四',
                    '星期五',
                    '星期六',
                ],
            },
        });

        new Vue({
            //this targets the div id app
            el: '#js-page-content',
            data() {
                return {
                    current: moment().format("lll"),
                    weatherForecast: '',
                    weatherUrl: '',
                    powerSummary: [],
                };
            },
            computed: {
                greenPercent() {
                    let generating = 0;
                    let consuming = 0;
                    this.powerSummary.forEach(p => {
                        generating += p.generating;
                        consuming += p.consuming;
                    });
                    if (consuming !== 0)
                        return `${Math.abs(generating * 100 / consuming).toFixed(2)}%`
                    else
                        return "0%";
                },
                devicePercent() {
                    let generating = 0;
                    this.powerSummary.forEach(p => {
                        generating += p.generating;
                    });

                    return `${Math.abs(generating * 100 / (688 + 1041)).toFixed(2)}%`
                }
            },
            async mounted() {
                await this.getSumUpChart('RdCenter');
                await this.getGreenPercentChart('RdCenter');
                await this.getSumUpChart('ITRI');
                await this.getGreenPercentChart('ITRI');
                await this.getPowerSummary();
            },
            methods: {
                async getPowerSummary() {
                    try {
                        const resp = await axios.get('/RealtimeStatus')
                        if (resp.status === 200) {
                            this.powerSummary = resp.data.summary;
                            console.log(this.powerSummary)
                        }
                    } catch (err) {
                        throw new Error('fail to get power summary')
                    }
                },
                async getSumUpChart(monitor) {
                    try {
                        let monitorTypes = ['generating', 'storing', 'consuming'];
                        let start = moment().subtract(7, 'days').valueOf();
                        let end = moment().valueOf();
                        const url = `/HistoryTrend/${monitor}/${monitorTypes.join(':')}/Hour/${start}/${end}`;
                        const res = await axios.get(url);
                        const ret = res.data;
                        ret.chart = {
                            type: "area",
                            zoomType: 'x',
                            panning: true,
                            panKey: 'shift',
                            alignTicks: false,
                        };

                        ret.colors = [
                            '#7CB5EC',
                            '#434348',
                            '#90ED7D',
                            '#F7A35C',
                            '#8085E9',
                            '#F15C80',
                            '#E4D354',
                            '#2B908F',
                            '#FB9FA8',
                            '#91E8E1',
                            '#7CB5EC',
                            '#80C535',
                            '#969696',
                        ];

                        ret.tooltip = {
                            pointFormat: '{series.name}: {point.y} KW<br/>Total: {point.stackTotal}',
                            valueDecimals: 2
                        };

                        ret.plotOptions = {
                            column: {
                                stacking: 'normal',
                                dataLabels: {
                                    enabled: true
                                }
                            },
                            valueDecimals: 2
                        };

                        ret.legend = { enabled: true };
                        ret.credits = {
                            enabled: false,
                            href: 'http://www.wecc.com.tw/',
                        };
                        ret.xAxis.type = 'datetime';
                        ret.xAxis.dateTimeLabelFormats = {
                            day: '%b%e日',
                            week: '%b%e日',
                            month: '%y年%b',
                        };

                        ret.time = {
                            timezoneOffset: -480,
                        };

                        ret.title = "";
                        Highcharts.chart(`${monitor}_sum`, ret);
                    } catch (err) {
                        throw new Error("failed to get sum chart!");
                    }
                },
                async getGreenPercentChart(monitor) {
                    try {
                        let monitorTypes = ['greenPercent'];
                        let start = moment().subtract(7, 'days').valueOf();
                        let end = moment().valueOf();
                        const url = `/HistoryTrend/${monitor}/${monitorTypes.join(':')}/Hour/${start}/${end}`;
                        const res = await axios.get(url);
                        const ret = res.data;
                        ret.chart = {
                            type: "column",
                            zoomType: 'x',
                            panning: true,
                            panKey: 'shift',
                            alignTicks: false,
                        };

                        ret.colors = [
                            '#7CB5EC',
                            '#434348',
                            '#90ED7D',
                            '#F7A35C',
                            '#8085E9',
                            '#F15C80',
                            '#E4D354',
                            '#2B908F',
                            '#FB9FA8',
                            '#91E8E1',
                            '#7CB5EC',
                            '#80C535',
                            '#969696',
                        ];

                        ret.tooltip = { valueDecimals: 2 };
                        ret.legend = { enabled: true };
                        ret.credits = {
                            enabled: false,
                            href: 'http://www.wecc.com.tw/',
                        };
                        ret.xAxis.type = 'datetime';
                        ret.xAxis.dateTimeLabelFormats = {
                            day: '%b%e日',
                            week: '%b%e日',
                            month: '%y年%b',
                        };

                        ret.time = {
                            timezoneOffset: -480,
                        };

                        ret.tooltip = {
                            pointFormat: '{series.name}: {point.y} %',
                            valueDecimals: 2
                        };
                        ret.title = "";
                        Highcharts.chart(`${monitor}_greenpercent`, ret);
                    } catch (err) {
                        throw new Error("failed to get sum chart!");
                    }
                },
            }
        });
    </script>

</body>
<!-- END Body -->

</html>